# 2023 MITRE eCTF Challenge: Protected Automotive Remote Entry Device (PARED)
# UNHaven Edition

This repository contains UNHaven's attempt at the PARED system for the 2032 MITRE's eCTF competition.

## Design Structure
- `car` - source code for building car devices
- `deployment` - source code for generating deployment-wide secrets
- `docker_env` - source code for creating docker build environment
- `fob` - source code for building key fob devices
- `host_tools` - source code for the host tools

## Protocol
See [PROTOCOL.md](PROTOCOL.md)

## Entropy Generation
Entropy is generated by using sysTick (the internal system timer) and a custom algorithm to increase entropy. 

sysTick was chosen as there really is no other source of entropy. The temperature sensor for example does not have enough noise LSBs to be usable for entropy. The ADC inputs in are not reliable as somebody could (as this is a dev board) input a stable or know-values into it.

A test was done with (`ent`)[https://www.fourmilab.ch/random/] where a test firmware generated 32 random bytes with the custom algorithm and echoed it back to the host. This data was piped into a file for 30 seconds, and was analyzed for entropy. The following is the result

```
   Entropy = 7.999119 bits per byte.

   Optimum compression would reduce the size
   of this 231480 byte file by 0 percent.

   Chi square distribution for 231480 samples is 283.88, and randomly
   would exceed this value 10.33 percent of the times.

   Arithmetic mean value of data bytes is 127.5255 (127.5 = random).
   Monte Carlo value for Pi is 3.126490410 (error 0.48 percent).
   Serial correlation coefficient is 0.001674 (totally uncorrelated = 0.0).
```

## Bug Reporting
As you (depending on who you are and when you are reading this) will attempt to find exploits in the firmware for the competition, we would like to ask for you to report them on Github as an Issue after the competition is over. That way we can learn on what vulnerabilities exist in this firmware and learn from our mistakes :)
Also you will get a free digital cookie (the good kind).

## Future Consideration
The firmware, in my (Electro707) opinion, is not production ready (i.e to go in a product). While it does work, there are a couple of things that should be tested and cleaned up before this can be considered shippable. Here is a TODO list for it:
- Have UART communication be interrupt-based instead of polling-based
- Do a penetration testing to see if one can get into the device (hey that's you!)
- Quality execution time
- Check the CPU processor speed and optimize if necessary
- Have cleaner data handling cases, and probably more of them (instead of assuming the input must be the correct format)
- Re-vamp the protocol to have a pre-fix/defined header (so the firmware knows that is start-of-frame)
- Have the tools have better exception handling
- Have a common source file for the firmware that is common to both the car and fob (instead of a copy)